<!DOCTYPE html>

<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  

  <title>Connecting to a Kubernetes Cluster - DC/OS Days</title>
  <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css">

  

  
    <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script>
  
  <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="http://localhost:4000" class="site-title fs-6 lh-tight">DC/OS Days</a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list">
    
    
      
        
          <li class="navigation-list-item active">
            
            <a href="http://localhost:4000/404.html" class="navigation-list-link"></a>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/getting%20setup.html" class="navigation-list-link">Getting Set Up</a>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item active">
            
            <a href="http://localhost:4000/" class="navigation-list-link"></a>
            
          </li>
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item active">
            
            <a href="http://localhost:4000/labs/kubernetes%20lab/kubernetes%20lab.html" class="navigation-list-link">Kubernetes Lab</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/labs/kubernetes%20lab/launch.html" class="navigation-list-link">Launch a Kubernetes Cluster</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item  active">
                      
                      <a href="http://localhost:4000/labs/kubernetes%20lab/connecting.html" class="navigation-list-link active">Connecting to a Kubernetes Cluster</a>
                      
                    </li>
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/labs/kubernetes%20lab/deploy.html" class="navigation-list-link">Deploying Another Kubernetes Cluster</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="http://localhost:4000/labs/kubernetes%20lab/scaling.html" class="navigation-list-link">Scaling a Kubernetes Cluster</a>
                      
                    </li>
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/labs/data%20services%20lab/data%20services%20lab.html" class="navigation-list-link">Data Services Lab</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/labs/monitoring/monitoring%20lab.html" class="navigation-list-link">Monitoring Lab</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/labs/cicd%20lab/cicd%20lab.html" class="navigation-list-link">CICD Lab</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="http://localhost:4000/labs/cassandra%20lab/cassandra%20lab.html" class="navigation-list-link">Cassandra Lab</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
  </ul>
</nav>

      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-000 mb-0">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          <div class="search js-search">
            <div class="search-input-wrap">
              <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search DC/OS Days" aria-label="Search DC/OS Days" autocomplete="off">
              <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg>
            </div>
            <div class="js-search-results search-results-wrap"></div>
          </div>
          
          
            <ul class="list-style-none text-small mt-md-1 mb-md-1 pb-4 pb-md-0 js-aux-nav aux-nav">
              
                <li class="d-inline-block my-0"><a href="//github.com/millerjem/dcos-days">Source</a></li>
              
            </ul>
          
        </div>
      </div>
      <div class="main-content">
        
          
            <nav class="breadcrumb-nav">
              <ol class="breadcrumb-nav-list">
                
                  <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/labs/kubernetes%20lab/kubernetes%20lab.html">Kubernetes Lab</a></li>
                
                <li class="breadcrumb-nav-list-item"><span>Connecting to a Kubernetes Cluster</span></li>
              </ol>
            </nav>
          
        
        <div id="main-content" class="page-content" role="main">
          <h1 id="lab-2---connecting-kubectl-to-dcos">Lab 2 - Connecting kubectl to DC/OS</h1>

<h3 id="step-1">Step 1</h3>
<p>Find public IP address of Public DC/OS Node</p>

<p>Your instructors have pre-installed the DC/OS Edge Load Balancer on your cluster and configured it to provide ingress to your Kuberenetes cluster’s control plane.</p>

<p>To attach <code class="highlighter-rouge">kubectl</code> to your cluster, you must point the configuration command below to the public IP address of the public DC/OS agent where Edge-LB is running.</p>

<p>Your DC/OS cluster contains 1 public agent nodes. To determine where Edge-LB is running, open your <code class="highlighter-rouge">clusterinfo.txt</code> file and note the IP addresses of your public agent.</p>

<p>Next, attempt to visit the following URL for your public agents:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;public agent public IP address&gt;:6090/haproxy?stats
</code></pre></div></div>

<p><img src="https://github.com/tbaums/dcos-k8s-days-labs/raw/master/screenshots/marathon-lb%20stats.png" alt="marathon-lb-stats" /></p>

<h3 id="step-2">Step 2</h3>
<p>Connecting using Kubeconfig</p>

<p>Configure kubectl to connect to the Kubernetes cluster running on  DC/OS using the following commands:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dcos kubernetes cluster kubeconfig \
    --insecure-skip-tls-verify \
    --context-name=kubernetes-cluster1 \
    --cluster-name=kubernetes-cluster1 \
    --apiserver-url=https://&lt;public agent where Edge-LB is running IP address&gt;:6443
</code></pre></div></div>

<p>Confirm connection:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get nodes
</code></pre></div></div>

<h3 id="step-3">Step 3</h3>
<p>Kubernetes Dashboard (Official UI of Kubernetes)</p>

<p>To access the dashboard run, we will expose the Kubernetes UI via a <code class="highlighter-rouge">NodePort</code> deployment on the Kubernetes cluster that we will access on our DC/OS public agent.</p>

<p>To begin, download <code class="highlighter-rouge">dashboard-ext.yaml</code> and save it to your local directory with the following command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -O https://raw.githubusercontent.com/tbaums/dcos-mandt-labs/master/clusters/setup/dashboard-ext.yaml
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/* Raw content of dashboard-ext.yaml */
apiVersion: v1
kind: Service
metadata:
  name: kubernetes-dashboard-ext
  namespace: kube-system
spec:
  type: NodePort
  selector:
    k8s-app: kubernetes-dashboard
  ports:
  - protocol: TCP
    nodePort: 30443
    port: 8443
</code></pre></div></div>

<p>Next, let’s create this deployment on our Kubernetes cluster:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl apply -f dashboard-ext.yaml
</code></pre></div></div>
<p>To authenticate to your Kubernetes dashboard, you will need your Kuberenetes <code class="highlighter-rouge">config</code> file, which contains your authorization token. Let’s put the config file in our present working directory for convenience:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Mac instructions
cp ~/.kube/config ./
</code></pre></div></div>

<p>To access your Kubernetes dashboard, point your web browser to the URL below:</p>

<p><em>Make sure to include <code class="highlighter-rouge">https://</code> in your URL</em></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://&lt;your DC/OS public agent public IP&gt;:30443
</code></pre></div></div>

<p>Lastly, find select your Kubernetes config file from the dialog box and click “Sign in”</p>

<p><img src="https://github.com/tbaums/dcos-mandt-labs/raw/master/screenshots/k8s-sign-in.png" alt="k8s-sign-in" /></p>

<p>Congratulations! You should now see the Kubernetes dashboard.</p>

<p><img src="https://github.com/tbaums/dcos-mandt-labs/raw/master/screenshots/k8s-dashboard.png" alt="k8s-dashboard" /></p>


          
        </div>
      </div>
    </div>
  </div>

</body>
</html>
